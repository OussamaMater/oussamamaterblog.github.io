{"componentChunkName":"component---src-templates-blog-post-js","path":"/laravel-sse/","result":{"data":{"site":{"siteMetadata":{"title":"Personal Blog"}},"markdownRemark":{"id":"9f4b0049-a935-58c7-a61d-04e311f4f336","excerpt":"Say Hi to Server-Sent Events If you've ever needed to implement a real-time feature in your web application, you're likely familiar with the complexity of usingâ€¦","html":"<h2>Say Hi to Server-Sent Events</h2>\n<p>If you've ever needed to implement a real-time feature in your web application, you're likely familiar with the complexity of using WebSockets or the resource-intensive nature of long-polling.</p>\n<p>Recently, I found myself in a situation where neither of them was an option, that's when I discovered <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Server-sent_events/Using_server-sent_events\">Server-Sent Events</a> (SSE), not only it was super easy to set up, but it also allowed me to achieve real-time communication in a fraction of the time it would have taken with WebSockets, and in this article, we will create a real-time notification using this technology.</p>\n<h2>How does SSE work?</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 620px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8f1cf9dcb7014b050e7e1248a413b132/935bc/sse.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 63.92405063291139%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe20Io//xAAYEAACAwAAAAAAAAAAAAAAAAAQEQABIf/aAAgBAQABBQJ65QQ//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGRABAQADAQAAAAAAAAAAAAAAAQAQESFh/9oACAEBAAE/IX1ho9k6tdwC/9oADAMBAAIAAwAAABCQD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABwQAAICAwEBAAAAAAAAAAAAAAABESExQVFxkf/aAAgBAQABPxBiZafCJGdcOgvXI5vexxWSnJ//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"sse\"\n        title=\"sse\"\n        src=\"/static/8f1cf9dcb7014b050e7e1248a413b132/935bc/sse.jpg\"\n        srcset=\"/static/8f1cf9dcb7014b050e7e1248a413b132/ff44c/sse.jpg 158w,\n/static/8f1cf9dcb7014b050e7e1248a413b132/a6688/sse.jpg 315w,\n/static/8f1cf9dcb7014b050e7e1248a413b132/935bc/sse.jpg 620w\"\n        sizes=\"(max-width: 620px) 100vw, 620px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>SSE allows a server to send real-time updates to a web page without the need for the client to constantly poll for new information.</p>\n<p>The flow is simple, the client establishes a connection with the server, and the server sends updates to the client over that connection as they occur, these updates are sent as \"events,\" which consist of a message and an optional event name.</p>\n<p>The client then can react to these events accordingly, by displaying a notification or updating the page.</p>\n<blockquote>\n<p>SSE is a good alternative to WebSockets only if your use case requires one-way communication, from Server to Client.</p>\n</blockquote>\n<h2>Let's use it in a Laravel project</h2>\n<p>Here is a preview of what we are going to build today</p>\n<img src=\"https://s2.gifyu.com/images/preview3650fa954fa82f3d.gif\" width=\"800\" height=\"500\">\n<h3>Installation</h3>\n<p>I will be using <a href=\"https://github.com/qruto/laravel-wave\">Laravel-Wave</a> package to implement SSE.</p>\n<p>Let's start by creating a new Laravel application</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">composer create-project laravel/laravel laravel-sse</code></pre></div>\n<p>For the server-side setup, we just need to pull the package</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">composer require qruto/laravel-wave</code></pre></div>\n<p>For the client-side setup, we need to install <code class=\"language-text\">Laravel Echo</code> and the adapter that comes with the package</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm install --save-dev laravel-echo laravel-wave</code></pre></div>\n<p>I will also install <code class=\"language-text\">sweetalert2</code> for this demo</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm install --save-dev sweetalert2</code></pre></div>\n<h3>Broadcast Notifications</h3>\n<blockquote>\n<p>Make sure to configure Laravel to broadcast events, <a href=\"https://laravel.com/docs/10.x/broadcasting#broadcast-service-provider\">docs</a>.</p>\n</blockquote>\n<p>Let's create a new Laravel event</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">php artisan make<span class=\"token punctuation\">:</span>event RealTimeNotification</code></pre></div>\n<p>We need to make a few changes to this event</p>\n<ul>\n<li>Make sure it implements the <code class=\"language-text\">ShouldBroadcast</code> interface.</li>\n<li>Make sure it returns <code class=\"language-text\">Channel</code> instead of <code class=\"language-text\">PrivateChannel</code>.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\r\n\r\n<span class=\"token keyword\">namespace</span> <span class=\"token package\">App<span class=\"token punctuation\">\\</span>Events</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">use</span> <span class=\"token package\">Illuminate<span class=\"token punctuation\">\\</span>Broadcasting<span class=\"token punctuation\">\\</span>Channel</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">use</span> <span class=\"token package\">Illuminate<span class=\"token punctuation\">\\</span>Broadcasting<span class=\"token punctuation\">\\</span>InteractsWithSockets</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">use</span> <span class=\"token package\">Illuminate<span class=\"token punctuation\">\\</span>Contracts<span class=\"token punctuation\">\\</span>Broadcasting<span class=\"token punctuation\">\\</span>ShouldBroadcast</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">use</span> <span class=\"token package\">Illuminate<span class=\"token punctuation\">\\</span>Foundation<span class=\"token punctuation\">\\</span>Events<span class=\"token punctuation\">\\</span>Dispatchable</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">use</span> <span class=\"token package\">Illuminate<span class=\"token punctuation\">\\</span>Queue<span class=\"token punctuation\">\\</span>SerializesModels</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">RealTimeNotification</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">ShouldBroadcast</span>\r\n<span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">use</span> <span class=\"token package\">Dispatchable</span><span class=\"token punctuation\">,</span> InteractsWithSockets<span class=\"token punctuation\">,</span> SerializesModels<span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token comment\">/**\r\n     * Create a new event instance.\r\n     */</span>\r\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span>\r\n        <span class=\"token keyword\">public</span> <span class=\"token keyword type-declaration\">string</span> <span class=\"token variable\">$message</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token comment\">/**\r\n     * Get the channels the event should broadcast on.\r\n     *\r\n     * @return array&lt;int, \\Illuminate\\Broadcasting\\Channel>\r\n     */</span>\r\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">broadcastOn</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword return-type\">array</span>\r\n    <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span>\r\n            <span class=\"token keyword\">new</span> <span class=\"token class-name\">Channel</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'events'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></span></code></pre></div>\n<p>Now we need to configure <code class=\"language-text\">Laravel Echo</code> to listen to the newly created event.</p>\n<p>In your <code class=\"language-text\">bootstrap.js</code>, add the following code</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> Swal <span class=\"token keyword\">from</span> <span class=\"token string\">'sweetalert2'</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">import</span> Echo <span class=\"token keyword\">from</span> <span class=\"token string\">'laravel-echo'</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> WaveConnector <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'laravel-wave'</span><span class=\"token punctuation\">;</span>\r\n\r\nwindow<span class=\"token punctuation\">.</span>Echo <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Echo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">broadcaster</span><span class=\"token operator\">:</span> WaveConnector <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\nwindow<span class=\"token punctuation\">.</span>Echo<span class=\"token punctuation\">.</span><span class=\"token function\">channel</span><span class=\"token punctuation\">(</span><span class=\"token string\">'events'</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token string\">'RealTimeNotification'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        Swal<span class=\"token punctuation\">.</span><span class=\"token function\">fire</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n            <span class=\"token literal-property property\">position</span><span class=\"token operator\">:</span> <span class=\"token string\">'top'</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token literal-property property\">icon</span><span class=\"token operator\">:</span> <span class=\"token string\">'success'</span><span class=\"token punctuation\">,</span>\r\n            <span class=\"token literal-property property\">title</span><span class=\"token operator\">:</span> e<span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">,</span>\r\n            <span class=\"token literal-property property\">showConfirmButton</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Now let's run <code class=\"language-text\">Vite</code> development server</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm run dev</code></pre></div>\n<p>Believe it or not, that's all you need to do to receive real-time notifications!</p>\n<h3>Test the notifications</h3>\n<p>First, let's add a route in our <code class=\"language-text\">web.php</code></p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token class-name static-context\">Route</span><span class=\"token operator\">::</span><span class=\"token function\">view</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'real-time-notifications'</span><span class=\"token punctuation\">,</span> <span class=\"token string single-quoted-string\">'sse'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>In your <code class=\"language-text\">resources/views/see.blade.php</code> add the following code</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>en<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\r\n\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\r\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>UTF-8<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\r\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>viewport<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>width=device-width, initial-scale=1.0<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\r\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">http-equiv</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>X-UA-Compatible<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>ie=edge<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\r\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>Real Time Notifications<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\r\n\r\n\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\r\n    @vite('resources/js/app.js')\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\r\n\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Now all that's left to do is to dispatch the <code class=\"language-text\">RealTimeNotification</code> event</p>\n<p>Start <code class=\"language-text\">tinker</code></p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\">php artisan tinker</code></pre></div>\n<p>Dispatch the event</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token function\">event</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name class-name-fully-qualified\"><span class=\"token punctuation\">\\</span>App<span class=\"token punctuation\">\\</span>Events<span class=\"token punctuation\">\\</span>RealTimeNotification</span><span class=\"token punctuation\">(</span><span class=\"token string double-quoted-string\">\"Hello World!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>You should see the alert popping up, like the preview above!</p>\n<h2>Conclusion</h2>\n<p>SSEs are simple to set up and use, but they may not be appropriate for every project, as they are unidirectional.</p>\n<p>Now that you know about them, it's up to you to decide between the straightforwardness of SSEs, which come with limitations, or the versatility of WebSockets, which is usable for all use cases but complex to implement.</p>","frontmatter":{"title":"Laravel Real-Time Notifications with SSE","date":"April 05, 2023","description":"Looking to add real-time notifications to your Laravel application, but without WebSockets and Long Polling? This article has got you covered!"}},"previous":{"fields":{"slug":"/overthewire/"},"frontmatter":{"title":"OverTheWire - Bandit"}},"next":{"fields":{"slug":"/vscode-and-laravel-pint/"},"frontmatter":{"title":"VS Code and Laravel Pint - 2 Methods"}}},"pageContext":{"id":"9f4b0049-a935-58c7-a61d-04e311f4f336","previousPostId":"a7c1d685-4f1e-560e-8d32-48d6883660f0","nextPostId":"79721fcb-0156-51de-84a3-c688b1586c86"}},"staticQueryHashes":["2841359383","494442451"],"slicesMap":{}}