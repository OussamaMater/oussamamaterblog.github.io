{"componentChunkName":"component---src-templates-blog-post-js","path":"/laravel-extend-the-framework/","result":{"data":{"site":{"siteMetadata":{"title":"Personal Blog"}},"markdownRemark":{"id":"b9cb6fee-efd3-5d99-8f39-2c41d579d437","excerpt":"Hello ðŸ‘‹  A few days ago, I was fixing a flaky test, and it turned out I needed some unique and valid values within my factory. Laravel wraps FakerPHP, which weâ€¦","html":"<h2 id=\"hello-\" style=\"position:relative;\"><a href=\"#hello-\" aria-label=\"hello  permalink\" class=\"anchor before\"><svg fill=\"#A855F7\" height=\"25px\" width=\"25px\" version=\"1.1\" id=\"Capa_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" \n              viewBox=\"0 0 490 490\" xml:space=\"preserve\">\n           <path d=\"M64.333,490h58.401l33.878-137.69h122.259L245.39,490h58.401l33.878-137.69h119.92v-48.162h-108.24l29.2-117.324h79.04\n             v-48.162H390.23L424.108,0H365.31l-33.878,138.661H208.79L242.668,0h-58.415l-33.864,138.661H32.411v48.162h106.298l-28.818,117.324\n             h-77.48v48.162h65.8L64.333,490z M197.11,186.824h122.642l-29.2,117.324H168.292L197.11,186.824z\"/>\n           </svg></a>Hello ðŸ‘‹</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c0500ab6664c47583e75304b00c7acfc/0f882/cover.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.316455696202528%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABK0lEQVR42hXMW26cMABA0dlE1GkGbGOMJ7zBGJgBg0gj5SOjKFIff93/Nm7Vs4BzWseel9QhLoZJStbiirNXWqOZGkPwJb4uUCKndTvOBW6uZ+kdcxUxaMnhE96DYSoUp5u1BJvipGKIJMFkjFpTRJK+yHk/VupupveefRsYm57Djxz7xN4ZplSzTgP73NKZ/2GdsVYpr0Yyi4RHuPMRPI9tZnIDx3JnCxu/vg7+/vng9+fB27bxeL3z80dgGXvmpqA2OZXOOfm6Yaxq5kiQPUtyrdn9lc1niEih4phzVNLWA2HyJGnD5bshu0hKa3nbGpZaIMQVqVpOWawoUovRlm9philK1ttM+ZLx9BShLikiLpGqQyQNIq4wZ0l8jsi0YRlyGquJni1x0vEPPuCYzzX8jwkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"cover\"\n        title=\"cover\"\n        src=\"/static/c0500ab6664c47583e75304b00c7acfc/f058b/cover.png\"\n        srcset=\"/static/c0500ab6664c47583e75304b00c7acfc/c26ae/cover.png 158w,\n/static/c0500ab6664c47583e75304b00c7acfc/6bdcf/cover.png 315w,\n/static/c0500ab6664c47583e75304b00c7acfc/f058b/cover.png 630w,\n/static/c0500ab6664c47583e75304b00c7acfc/40601/cover.png 945w,\n/static/c0500ab6664c47583e75304b00c7acfc/78612/cover.png 1260w,\n/static/c0500ab6664c47583e75304b00c7acfc/0f882/cover.png 1584w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>A few days ago, I was fixing a flaky test, and it turned out I needed some <strong>unique</strong> and <strong>valid</strong> values within my factory. Laravel wraps FakerPHP, which we usually access through the <code class=\"language-text\">fake()</code> helper. FakerPHP comes with modifiers like <code class=\"language-text\">valid()</code> and <code class=\"language-text\">unique()</code>, but you can use only one at a time, so you can't do <code class=\"language-text\">fake()->unique()->valid()</code>, which is exactly what I needed. This made me think, what if we want to create our own modifier? For example, <code class=\"language-text\">uniqueAndValid()</code>, or any other modifier. How can we <em>extend</em> the framework?</p>\n<h2 id=\"thinking-out-loud\" style=\"position:relative;\"><a href=\"#thinking-out-loud\" aria-label=\"thinking out loud permalink\" class=\"anchor before\"><svg fill=\"#A855F7\" height=\"25px\" width=\"25px\" version=\"1.1\" id=\"Capa_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" \n              viewBox=\"0 0 490 490\" xml:space=\"preserve\">\n           <path d=\"M64.333,490h58.401l33.878-137.69h122.259L245.39,490h58.401l33.878-137.69h119.92v-48.162h-108.24l29.2-117.324h79.04\n             v-48.162H390.23L424.108,0H365.31l-33.878,138.661H208.79L242.668,0h-58.415l-33.864,138.661H32.411v48.162h106.298l-28.818,117.324\n             h-77.48v48.162h65.8L64.333,490z M197.11,186.824h122.642l-29.2,117.324H168.292L197.11,186.824z\"/>\n           </svg></a>Thinking out loud</h2>\n<blockquote>\n<p>I will be dumping my train of thought.</p>\n</blockquote>\n<p>Before jumping into any over-engineered solution, I always want to check if there is a simpler option and understand what I'm dealing with. So, let's take a look at the <code class=\"language-text\">fake()</code> helper:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token keyword\">function</span> <span class=\"token function-definition function\">fake</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$locale</span> <span class=\"token operator\">=</span> <span class=\"token constant\">null</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">app</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">bound</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'config'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$locale</span> <span class=\"token operator\">??=</span> <span class=\"token function\">app</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'config'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'app.faker_locale'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token variable\">$locale</span> <span class=\"token operator\">??=</span> <span class=\"token string single-quoted-string\">'en_US'</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token variable\">$abstract</span> <span class=\"token operator\">=</span> <span class=\"token class-name class-name-fully-qualified static-context\"><span class=\"token punctuation\">\\</span>Faker<span class=\"token punctuation\">\\</span>Generator</span><span class=\"token operator\">::</span><span class=\"token keyword\">class</span><span class=\"token operator\">.</span><span class=\"token string single-quoted-string\">':'</span><span class=\"token operator\">.</span><span class=\"token variable\">$locale</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span> <span class=\"token function\">app</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">bound</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abstract</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">app</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">singleton</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abstract</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">fn</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token class-name class-name-fully-qualified static-context\"><span class=\"token punctuation\">\\</span>Faker<span class=\"token punctuation\">\\</span>Factory</span><span class=\"token operator\">::</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$locale</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token function\">app</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">make</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abstract</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Reading the code, we can see that Laravel binds a singleton to the container. However, if we inspect the abstract, it's a regular class that does not implement any interface, and the object is created via a factory. This complicates things. Why?</p>\n<ol>\n<li>Because if it were an interface, we could just create a new class that extends the base <code class=\"language-text\">\\Faker\\Generator</code> class, add some new features, and rebind it to the container. But we don't have this luxury.</li>\n<li>There is a factory involved. This means it's not a simple instantiation, there is some logic being run. In this case, the factory adds some providers (PhoneNumber, Text, UserAgent, etc..). So, even if we try to rebind, we will have to use the factory, which will return the original <code class=\"language-text\">\\Faker\\Generator</code>.</li>\n</ol>\n<p>Solutions ðŸ¤”? One might think, \"What's stopping us from creating our own factory that returns the new generator as outlined in point 1?\" Well, nothing, we can do that, but we won't! We use a framework for several reasons, one of them being updates. What will happen if FakerPHP adds a new provider or has a major upgrade? Laravel will adjust the code, and people who haven't made any changes won't notice anything. However, we would be left out, and our code might even break (most likely). So, yes, we don't want to go that far.</p>\n<h2 id=\"so-what-do-we-do\" style=\"position:relative;\"><a href=\"#so-what-do-we-do\" aria-label=\"so what do we do permalink\" class=\"anchor before\"><svg fill=\"#A855F7\" height=\"25px\" width=\"25px\" version=\"1.1\" id=\"Capa_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" \n              viewBox=\"0 0 490 490\" xml:space=\"preserve\">\n           <path d=\"M64.333,490h58.401l33.878-137.69h122.259L245.39,490h58.401l33.878-137.69h119.92v-48.162h-108.24l29.2-117.324h79.04\n             v-48.162H390.23L424.108,0H365.31l-33.878,138.661H208.79L242.668,0h-58.415l-33.864,138.661H32.411v48.162h106.298l-28.818,117.324\n             h-77.48v48.162h65.8L64.333,490z M197.11,186.824h122.642l-29.2,117.324H168.292L197.11,186.824z\"/>\n           </svg></a>So, what do we do?</h2>\n<p>Now that we've explored the basic options, we can start thinking of more advanced ones, like design patterns. We don't need an exact implementation, just something familiar to our problem. This is why I always say it's good to know them. In this case, we can \"decorate\" the <code class=\"language-text\">Generator</code> class by adding new features while maintaining the old ones. Sounds good? Let's see how!</p>\n<p>First, let's create a new class, <code class=\"language-text\">FakerGenerator</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n\n<span class=\"token keyword\">namespace</span> <span class=\"token package\">App<span class=\"token punctuation\">\\</span>Support</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">use</span> <span class=\"token package\">Closure</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">Faker<span class=\"token punctuation\">\\</span>Generator</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">Illuminate<span class=\"token punctuation\">\\</span>Support<span class=\"token punctuation\">\\</span>Traits<span class=\"token punctuation\">\\</span>ForwardsCalls</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">FakerGenerator</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">use</span> <span class=\"token package\">ForwardsCalls</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__construct</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">private</span> <span class=\"token keyword\">readonly</span> <span class=\"token class-name type-declaration\">Generator</span> <span class=\"token variable\">$generator</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">uniqueAndValid</span><span class=\"token punctuation\">(</span><span class=\"token class-name type-declaration\">Closure</span> <span class=\"token variable\">$validator</span> <span class=\"token operator\">=</span> <span class=\"token constant\">null</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">UniqueAndValidGenerator</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">generator</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$validator</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">__call</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$method</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$parameters</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token function\">forwardCallTo</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">generator</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$method</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$parameters</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></span></code></pre></div>\n<p>This will be our \"decorator\" (kinda). It is a simple class that expects the base <code class=\"language-text\">Generator</code> as a dependency and introduces a new modifier, <code class=\"language-text\">uniqueAndValid()</code>. It also uses the <code class=\"language-text\">ForwardsCalls</code> trait from Laravel, which allows it to proxy calls to the base object.</p>\n<blockquote>\n<p>This trait has two methods: <code class=\"language-text\">forwardCallTo</code> and <code class=\"language-text\">forwardDecoratedCallTo</code>. Use the latter when you want to chain methods on the decorated object. In our case, we will always have a single call.</p>\n</blockquote>\n<p>Now we need to implement the <code class=\"language-text\">UniqueAndValidGenerator</code>, which is the custom modifier, but this is not the point of the article. If you are interested in the implementation, this class is basically a mixture of the <a href=\"https://github.com/FakerPHP/Faker/blob/2.0/src/ValidGenerator.php\" target=\"_blank\">ValidGenerator</a> and <a href=\"https://github.com/FakerPHP/Faker/blob/2.0/src/UniqueGenerator.php\" target=\"_blank\">UniqueGenerator</a> that ship with FakerPHP, you can find it <a href=\"https://gist.github.com/OussamaMater/b5cb099d81529c8feb503ecdd5469183\" target=\"_blank\">here</a>.</p>\n<p>Now, let's <em>extend</em> the framework, in the <code class=\"language-text\">AppServiceProvider</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n\n<span class=\"token keyword\">namespace</span> <span class=\"token package\">App<span class=\"token punctuation\">\\</span>Providers</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">use</span> <span class=\"token package\">Closure</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">Faker<span class=\"token punctuation\">\\</span>Generator</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">App<span class=\"token punctuation\">\\</span>Support<span class=\"token punctuation\">\\</span>FakerGenerator</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">use</span> <span class=\"token package\">Illuminate<span class=\"token punctuation\">\\</span>Support<span class=\"token punctuation\">\\</span>ServiceProvider</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name-definition class-name\">AppServiceProvider</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">ServiceProvider</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">register</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword return-type\">void</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">app</span><span class=\"token operator\">-></span><span class=\"token function\">extend</span><span class=\"token punctuation\">(</span>\n            <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token function\">fakerAbstractName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> \n            <span class=\"token keyword\">fn</span> <span class=\"token punctuation\">(</span><span class=\"token class-name type-declaration\">Generator</span> <span class=\"token variable\">$base</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FakerGenerator</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$base</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">fakerAbstractName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword return-type\">string</span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// This is important, it matches the name bound by the fake() helper</span>\n        <span class=\"token keyword\">return</span> <span class=\"token class-name static-context\">Generator</span><span class=\"token operator\">::</span><span class=\"token keyword\">class</span> <span class=\"token operator\">.</span> <span class=\"token string single-quoted-string\">':'</span> <span class=\"token operator\">.</span> <span class=\"token function\">app</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'config'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-></span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string single-quoted-string\">'app.faker_locale'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></span></code></pre></div>\n<p>The <code class=\"language-text\">extend()</code> method checks if an abstract matching the given name has been bound to the container. If so, it overrides its value with the result of the closure, take a look:</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language-php\"><code class=\"language-php\"><span class=\"token comment\">// Laravel: src/Illuminate/Container/Container.php</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">function</span> <span class=\"token function-definition function\">extend</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abstract</span><span class=\"token punctuation\">,</span> <span class=\"token class-name type-declaration\">Closure</span> <span class=\"token variable\">$closure</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$abstract</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token function\">getAlias</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abstract</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">instances</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$abstract</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n         <span class=\"token comment\">// You are interested here</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">instances</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$abstract</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$closure</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">instances</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$abstract</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token variable\">$this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token function\">rebound</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abstract</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token property\">extenders</span><span class=\"token punctuation\">[</span><span class=\"token variable\">$abstract</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token variable\">$closure</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token function\">resolved</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abstract</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token variable\">$this</span><span class=\"token operator\">-></span><span class=\"token function\">rebound</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$abstract</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>That's why we defined the <code class=\"language-text\">fakerAbstractName()</code> method, which generates the same name the <code class=\"language-text\">fake()</code> helper binds in the container.</p>\n<blockquote>\n<p>Recheck the code above if you missed it, I left a comment.</p>\n</blockquote>\n<p>Now, every time we call <code class=\"language-text\">fake()</code>, an instance of <code class=\"language-text\">FakerGenerator</code> will be returned, and we will have access to the custom modifier we introduced. Every time we invoke a call that does not exist on the <code class=\"language-text\">FakerGenerator</code> class, <code class=\"language-text\">__call()</code> will be triggered, and it will proxy it to the base <code class=\"language-text\">Generator</code> using the <code class=\"language-text\">forwardCallTo()</code> method.</p>\n<p>That's it! I can finally do <code class=\"language-text\">fake()->uniqueAndValid()->randomElement()</code>, and it works like a charm!</p>\n<blockquote>\n<p>Before we conclude, I want to point out that this is not a pure decorator pattern. However, patterns are not sacred texts; tweak them to fit your needs and solve the problem.</p>\n</blockquote>\n<h2 id=\"conclusion\" style=\"position:relative;\"><a href=\"#conclusion\" aria-label=\"conclusion permalink\" class=\"anchor before\"><svg fill=\"#A855F7\" height=\"25px\" width=\"25px\" version=\"1.1\" id=\"Capa_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" \n              viewBox=\"0 0 490 490\" xml:space=\"preserve\">\n           <path d=\"M64.333,490h58.401l33.878-137.69h122.259L245.39,490h58.401l33.878-137.69h119.92v-48.162h-108.24l29.2-117.324h79.04\n             v-48.162H390.23L424.108,0H365.31l-33.878,138.661H208.79L242.668,0h-58.415l-33.864,138.661H32.411v48.162h106.298l-28.818,117.324\n             h-77.48v48.162h65.8L64.333,490z M197.11,186.824h122.642l-29.2,117.324H168.292L197.11,186.824z\"/>\n           </svg></a>Conclusion</h2>\n<p>Frameworks are incredibly helpful, and Laravel comes with a lot of built-in features. However, they can't cover all the edge cases in your projects, and sometimes you might hit a dead end. When that happens, you can always extend the framework. We've seen how simple it is, and I hope you understood the main idea, which applies beyond just this Faker example.</p>\n<p>Always start simple and look for the simplest solution to the problem. Complexity will come when it's necessary, so if basic inheritance does the trick, there's no need to implement a decorator or anything else. When you do extend the framework, ensure you don't go too far, where the loss outweighs the gain. You don't want to end up maintaining a part of the framework on your own.</p>\n<blockquote>\n<p>If you have any thoughts we can include in the article, feel free to ping me!</p>\n</blockquote>","frontmatter":{"title":"Laravel Under The Hood - Extending the framework","date":"May 27, 2024","description":"Laravel comes with tons of features, but sometimes, for your specific edge case, you need to extend the framework just a little bit. I will show you how!"}},"previous":{"fields":{"slug":"/laravel-the-strategy-pattern/"},"frontmatter":{"title":"Laravel Under The Hood - The Strategy Pattern"}},"next":null},"pageContext":{"id":"b9cb6fee-efd3-5d99-8f39-2c41d579d437","previousPostId":"fe898d33-977f-5b82-856a-cf95b77ac8e3","nextPostId":null}},"staticQueryHashes":["2841359383","494442451"],"slicesMap":{}}